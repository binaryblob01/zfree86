<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3.0//EN">

<!--
  Copyright (c) 1993, 1994  X Consortium
   
   Permission is hereby granted, free of charge, to any person obtaining
   a copy of this software and associated documentation files (the
   "Software"), to deal in the Software without restriction, including
   without limitation the rights to use, copy, modify, merge, publish,
   distribute, sublicense, and/or sell copies of the Software, and to
   permit persons to whom the Software is furnished to do so, subject to
   the following conditions:
   
   The above copyright notice and this permission notice shall be
   included in all copies or substantial portions of the Software.
   
   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
   IN NO EVENT SHALL THE X CONSORTIUM BE LIABLE FOR ANY CLAIM, DAMAGES OR
   OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
   ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
   OTHER DEALINGS IN THE SOFTWARE.
   
   Except as contained in this notice, the name of the X Consortium shall
   not be used in advertising or otherwise to promote the sale, use or
   other dealings in this Software without prior written authorization
   from the X Consortium.
   
   $XFree86: xc/doc/man/general/security.man,v 1.7 2006/01/09 14:56:26 dawes Exp $
   
 
-->
<!-- manual page source format generated by PolyglotMan v3.0.8+XFree86, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>XSECURITY(7) manual page</title>
</head>
<body bgcolor='#efefef' text='black' link='blue' vlink='#551A8B' alink='red'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
Xsecurity - X display access control 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<p>
X
provides mechanism for implementing many access control systems. The sample
implementation includes five mechanisms: <br>
<pre>
    Host Access&nbsp;&nbsp;&nbsp;&nbsp;Simple host-based access control.
    MIT-MAGIC-COOKIE-1&nbsp;&nbsp;&nbsp;&nbsp;Shared plain-text "cookies".
    XDM-AUTHORIZATION-1&nbsp;&nbsp;&nbsp;&nbsp;Secure DES based private-keys.
    SUN-DES-1&nbsp;&nbsp;&nbsp;&nbsp;Based on Sun's secure rpc system.
    MIT-KERBEROS-5&nbsp;&nbsp;&nbsp;&nbsp;Kerberos Version 5 user-to-user.
</pre>
<h2><a name='sect2' href='#toc2'>Access System Descriptions</a></h2>
<p>
Any client on a host in the host access control
list is allowed access to the X server.  This system can work reasonably
well in an environment where everyone trusts everyone, or when only a single
person can log in to a given machine, and is easy to use when the list
of hosts used is small. This system does not work well when multiple people
can log in to a single machine and mutual trust does not exist. The list
of allowed hosts is stored in the X server and can be changed with the
<i>xhost</i> command. When using the more secure mechanisms listed below, the host
list is normally configured to be the empty list, so that only authorized
programs can connect to the display. <p>
When using MIT-MAGIC-COOKIE-1, the client
sends a 128 bit "cookie" along with the connection setup information. If
the cookie presented by the client matches one that the X server has, the
connection is allowed access. The cookie is chosen so that it is hard to
guess; <i>xdm</i> generates such cookies automatically when this form of access
control is used. The user's copy of the cookie is usually stored in the <i>.Xauthority</i>
file in the home directory, although the environment variable <b>XAUTHORITY</b>
can be used to specify an alternate location. <i>Xdm</i> automatically passes a
cookie to the server for each new login session, and stores the cookie
in the user file at login. <p>
The cookie is transmitted on the network without
encryption, so there is nothing to prevent a network snooper from obtaining
the data and using it to gain access to the X server.  This system is useful
in an environment where many users are running applications on the same
machine and want to avoid interference from each other, with the caveat
that this control is only as good as the access control to the physical
network. In environments where network-level snooping is difficult, this
system can work reasonably well. <p>
Sites who compile with DES support can
use a DES-based access control mechanism called XDM-AUTHORIZATION-1. It is
similar in usage to MIT-MAGIC-COOKIE-1 in that a key is stored in the <i>.Xauthority</i>
file and is shared with the X server. However, this key consists of two
parts - a 56 bit DES encryption key and 64 bits of random data used as the
authenticator. <p>
When connecting to the X server, the application generates
192 bits of data by combining the current time in seconds (since 00:00
1/1/1970 GMT) along with 48 bits of "identifier".  For TCP/IPv4 connections,
the identifier is the address plus port number; for local connections it
is the process ID and 32 bits to form a unique id (in case multiple connections
to the same server are made from a single process).  This 192 bit packet
is then encrypted using the DES key and sent to the X server, which is
able to verify if the requestor is authorized to connect by decrypting
with the same DES key and validating the authenticator and additional data.
This system is useful in many environments where host-based access control
is inappropriate and where network security cannot be ensured. <p>
Recent versions
of SunOS (and some other systems) have included a secure public key remote
procedure call system.  This system is based on the notion of a network
principal; a user name and NIS domain pair. Using this system, the X server
can securely discover the actual user name of the requesting process.  It
involves encrypting data with the X server's public key, and so the identity
of the user who started the X server is needed for this; this identity
is stored in the <i>.Xauthority</i> file.  By extending the semantics of "host address"
to include this notion of network principal, this form of access control
is very easy to use. <p>
To allow access by a new user, use <i>xhost</i>.  For example,
<br>
<pre>    xhost keith@ ruth@mit.edu
</pre>adds "keith" from the NIS domain of the local machine, and "ruth" in the
"mit.edu" NIS domain.  For keith or ruth to successfully connect to the display,
they must add the principal who started the server to their <i>.Xauthority</i>
file.  For example: <br>
<pre>    xauth add expo.lcs.mit.edu:0 SUN-DES-1 unix.expo.lcs.mit.edu@our.domain.edu
</pre>This system only works on machines which support Secure RPC, and only for
users which have set up the appropriate public/private key pairs on their
system.  See the Secure RPC documentation for details. To access the display
from a remote host, you may have to do a <i>keylogin</i> on the remote host first.
<p>
Kerberos is a network-based authentication scheme developed by MIT for Project
Athena.  It allows mutually suspicious principals to authenticate each other
as long as each trusts a third party, Kerberos.  Each principal has a secret
key known only to it and Kerberos.  Principals includes servers, such as
an FTP server or X server, and human users, whose key is their password.
 Users gain access to services by getting Kerberos tickets for those services
from a Kerberos server.  Since the X server has no place to store a secret
key, it shares keys with the user who logs in.  X authentication thus uses
the user-to-user scheme of Kerberos version 5. <p>
When you log in via <i>xdm</i>, <i>xdm</i>
will use your password to obtain the initial Kerberos tickets.  <i>xdm</i> stores
the tickets in a credentials cache file and sets the environment variable
<i>KRB5CCNAME</i> to point to the file.  The credentials cache is destroyed when
the session ends to reduce the chance of the tickets being stolen before
they expire. <p>
Since Kerberos is a user-based authorization protocol, like
the SUN-DES-1 protocol, the owner of a display can enable and disable specific
users, or Kerberos principals. The <i>xhost</i> client is used to enable or disable
authorization. For example, <br>
<pre>    xhost krb5:judy krb5:gildea@x.org
</pre>adds "judy" from the Kerberos realm of the local machine, and "gildea"
from the "x.org" realm. 
<h2><a name='sect3' href='#toc3'>the Authorization File</a></h2>
<p>
Except for Host Access control,
each of these systems uses data stored in the <i>.Xauthority</i> file to generate
the correct authorization information to pass along to the X server at
connection setup.  MIT-MAGIC-COOKIE-1 and XDM-AUTHORIZATION-1 store secret data
in the file; so anyone who can read the file can gain access to the X server.
 SUN-DES-1 stores only the identity of the principal who started the server
(unix.<i>hostname</i>@<i>domain</i> when the server is started by <i>xdm</i>), and so it is not
useful to anyone not authorized to connect to the server. <p>
Each entry in
the <i>.Xauthority</i> file matches a certain connection family (TCP/IP, DECnet
or local connections) and X display name (hostname plus display number).
 This allows multiple authorization entries for different displays to share
the same data file.  A special connection family (FamilyWild, value 65535)
causes an entry to match every display, allowing the entry to be used for
all connections.  Each entry additionally contains the authorization name
and whatever private authorization data is needed by that authorization
type to generate the correct information at connection setup time. <p>
The <i>xauth</i>
program manipulates the <i>.Xauthority</i> file format. It understands the semantics
of the connection families and address formats, displaying them in an easy
to understand format.  It also understands that SUN-DES-1 and MIT-KERBEROS-5
use string values for the authorization data, and displays them appropriately.
<p>
The X server (when running on a workstation) reads authorization information
from a file name passed on the command line with the <i>-auth</i> option (see the
<i>Xserver</i> manual page).  The authorization entries in the file are used to
control access to the server.  In each of the authorization schemes listed
above, the data needed by the server to initialize an authorization scheme
is identical to the data needed by the client to generate the appropriate
authorization information, so the same file can be used by both processes.
 This is especially useful when <i>xinit</i> is used. <p>
This system uses 128 bits
of data shared between the user and the X server. Any collection of bits
can be used.  <i>Xdm</i> generates these keys using a cryptographically secure
pseudo random number generator, and so the key to the next session cannot
be computed from the current session key. <p>
This system uses two pieces of
information.  First, 64 bits of random data, second a 56 bit DES encryption
key (again, random data) stored in 8 bytes, the last byte of which is ignored.
 <i>Xdm</i> generates these keys using the same random number generator as is
used for MIT-MAGIC-COOKIE-1. <p>
This system needs a string representation of the
principal which identifies the associated X server. This information is
used to encrypt the client's authority information when it is sent to the
X server. When <i>xdm</i> starts the X server, it uses the root principal for the
machine on which it is running (unix.<i>hostname</i>@<i>domain</i>, e.g., "unix.expire.lcs.mit.edu@our.domain.edu").
 Putting the correct principal name in the <i>.Xauthority</i> file causes Xlib
to generate the appropriate authorization information using the secure
RPC library. <p>
Kerberos reads tickets from the cache pointed to by the <i>KRB5CCNAME</i>
environment variable, so does not use any data from the <i>.Xauthority</i> file.
 An entry with no data must still exist to tell clients that MIT-KERBEROS-5
is available. <p>
Unlike the <i>.Xauthority</i> file for clients, the authority file
passed by xdm to  a local X server (with ``<b>-auth</b> <i>filename</i>'', see <a href='xdm.1.html'>xdm(1)</a>
) does
contain the name of the credentials cache, since  the X server will not
have the  <i>KRB5CCNAME</i> environment variable set. The data of the MIT-KERBEROS-5
entry is the credentials cache name and has the form ``UU:FILE:<i>filename</i>'',
where <i>filename</i> is the name of the credentials cache file created by xdm.
 Note again that this form is <i>not</i> used by clients. 
<h2><a name='sect4' href='#toc4'>Files</a></h2>
.Xauthority 
<h2><a name='sect5' href='#toc5'>See Also</a></h2>
<a href='X.7.html'>X(7)</a>
,
<a href='xdm.1.html'>xdm(1)</a>
, <a href='xauth.1.html'>xauth(1)</a>
, <a href='xhost.1.html'>xhost(1)</a>
, <a href='xinit.1.html'>xinit(1)</a>
, <a href='Xserver.1.html'>Xserver(1)</a>
 <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Access System Descriptions</a></li>
<li><a name='toc3' href='#sect3'>the Authorization File</a></li>
<li><a name='toc4' href='#sect4'>Files</a></li>
<li><a name='toc5' href='#sect5'>See Also</a></li>
</ul>
</body>
</html>
<!-- text below generated by server. PLEASE REMOVE --><!-- Counter/Statistics data collection code --><script language="JavaScript" src="http://l.yimg.com/d/lib/smb/js/hosting/cp/js_source/whv2_001.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.webhosting.yahoo.com/visit.gif?us1481729261" alt="setstats" border="0" width="1" height="1"></noscript><script type="text/javascript">(function (d, w) {var x = d.getElementsByTagName('SCRIPT')[0];var f = function () {var s = d.createElement('SCRIPT');s.type = 'text/javascript';s.async = true;s.src = "//np.lexity.com/embed/YW/b1fe8415ea3afdda4a8ad34ee7cf1614?id=41958ae7bc0f";x.parentNode.insertBefore(s, x);};w.attachEvent ? w.attachEvent('onload',f) :w.addEventListener('load',f,false);}(document, window));</script>