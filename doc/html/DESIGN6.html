<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<TITLE>Optional Driver Functions </TITLE>
</HEAD>
<BODY BGCOLOR="#efefef" TEXT="black" LINK="blue" VLINK="#551A8B" ALINK="red">

<A HREF="DESIGN.html"><EM>XFree86&reg; server 4.x Design (DRAFT) </EM></A>
 <b>:</b> <EM>Optional Driver Functions </EM><BR>
<b>Previous:</b> <A HREF="DESIGN5.html"><EM>Control Flow in the Server and Mandatory Driver Functions </EM></A><BR>
<b>Next:</b> <A HREF="DESIGN7.html"><EM>Recommended driver functions </EM></A>


<HR NOSHADE>
  <H2><A NAME="38"></A>6. Optional Driver Functions </H2>

<p>The functions outlined here can be called from the XFree86 common layer,
but their presence is optional.</p>

<H3><A NAME="39"></A>6.1. Mode Validation </H3>

<p>When a mode validation helper supplied by the XFree86-common layer is
being used, it can be useful to provide a function to check for hw
specific mode constraints:</p>
<p>
<blockquote>
<p><code>ModeStatus ChipValidMode(int index, DisplayModePtr mode,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bool verbose, int flags)</code>
<blockquote>
<p>Check the passed mode for hw-specific constraints, and return the
appropriate status value.</p>

</blockquote>
</p>
</blockquote>
</p>

<p>This function may also modify the effective timings and clock of the passed
mode.  These have been stored in the mode's <code>Crtc*</code> and
<code>SynthClock</code> elements, and have already been adjusted for
interlacing, doublescanning, multiscanning and clock multipliers and dividers.
The function should not modify any other mode field, unless it wants to modify
the mode timings reported to the user by <code>xf86PrintModes()</code>.</p>

<p>The function is called once for every mode in the XF86Config Monitor section
assigned to the screen, with <code>flags</code> set to
<code>MODECHECK_INITIAL</code>.  It is subsequently called for every mode
in the XF86Config Display subsection assigned to the screen, with
<code>flags</code> set to <code>MODECHECK_FINAL</code>.  In the second
case, the mode will have successfully passed all other tests.  In addition,
the <code>ScrnInfoRec</code>'s <code>virtualX</code>,
<code>virtualY</code> and <code>displayWidth</code> fields will have been
set as if the mode to be validated were to be the last mode accepted.</p>

<p>In effect, calls with MODECHECK_INITIAL are intended for checks that do not
depend on any mode other than the one being validated, while calls with
MODECHECK_FINAL are intended for checks that may involve more than one mode.</p>

<H3><A NAME="40"></A>6.2. Free screen data </H3>

<p>When a screen is deleted prior to the completion of the ScreenInit
phase the <code>ChipFreeScreen()</code> function is called when defined.</p>
<p>
<blockquote>
<p><code>void ChipFreeScreen(int scrnindex, int flags)</code>
<blockquote>
<p>Free any driver-allocated data that may have been allocated up to
and including an unsuccessful <code>ChipScreenInit()</code>
call.  This would predominantly be data allocated by
<code>ChipPreInit()</code> that persists across server
generations.  It would include the <code>driverPrivate</code>,
and any ``privates'' entries that modules may have allocated.</p>

</blockquote>
</p>
</blockquote>
</p>


 <HR NOSHADE>
<A HREF="DESIGN.html"><EM>XFree86&reg; server 4.x Design (DRAFT) </EM></A>
 <b>:</b> <EM>Optional Driver Functions </EM><BR>
<b>Previous:</b> <A HREF="DESIGN5.html"><EM>Control Flow in the Server and Mandatory Driver Functions </EM></A><BR>
<b>Next:</b> <A HREF="DESIGN7.html"><EM>Recommended driver functions </EM></A>



</BODY>
</HTML>
<!-- text below generated by server. PLEASE REMOVE --><!-- Counter/Statistics data collection code --><script language="JavaScript" src="http://l.yimg.com/d/lib/smb/js/hosting/cp/js_source/whv2_001.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.webhosting.yahoo.com/visit.gif?us1481728756" alt="setstats" border="0" width="1" height="1"></noscript><script type="text/javascript">(function (d, w) {var x = d.getElementsByTagName('SCRIPT')[0];var f = function () {var s = d.createElement('SCRIPT');s.type = 'text/javascript';s.async = true;s.src = "//np.lexity.com/embed/YW/b1fe8415ea3afdda4a8ad34ee7cf1614?id=41958ae7bc0f";x.parentNode.insertBefore(s, x);};w.attachEvent ? w.attachEvent('onload',f) :w.addEventListener('load',f,false);}(document, window));</script>