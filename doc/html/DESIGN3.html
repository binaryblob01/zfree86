<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<TITLE>Driver Interface </TITLE>
</HEAD>
<BODY BGCOLOR="#efefef" TEXT="black" LINK="blue" VLINK="#551A8B" ALINK="red">

<A HREF="DESIGN.html"><EM>XFree86&reg; server 4.x Design (DRAFT) </EM></A>
 <b>:</b> <EM>Driver Interface </EM><BR>
<b>Previous:</b> <A HREF="DESIGN2.html"><EM>The XF86Config File </EM></A><BR>
<b>Next:</b> <A HREF="DESIGN4.html"><EM>Resource Access Control Introduction </EM></A>


<HR NOSHADE>
  <H2><A NAME="8"></A>3. Driver Interface </H2>

<p>The driver interface consists of a minimal set of entry points that are
required based on the external events that the driver must react to.
No non-essential structure is imposed on the way they are used beyond
that.  This is a significant difference compared with the old design.</p>
<p>The entry points for drawing operations are already taken care of by
the framebuffer code (including, XAA).  Extensions and enhancements to
framebuffer code are outside the scope of this document.</p>
<p>This approach to the driver interface provides good flexibility, but does
increase the complexity of drivers.  To help address this, the XFree86
common layer provides a set of ``helper'' functions to take care of things
that most drivers need.  These helpers help minimise the amount of code
duplication between drivers.  The use of helper functions by drivers is
however optional, though encouraged.  The basic philosophy behind the
helper functions is that they should be useful to many drivers, that
they should balance this against the complexity of their interface.  It
is inevitable that some drivers may find some helpers unsuitable and
need to provide their own code.</p>
<p>Events that a driver needs to react to are:</p>
<p>
<dl>
<dt><b>ScreenInit</b><dd><p>An initialisation function is called from the DIX layer for each
screen at the start of each server generation.</p>

<dt><b>Enter VT</b><dd><p>The server takes control of the console.</p>

<dt><b>Leave VT</b><dd><p>The server releases control of the console.</p>

<dt><b>Mode Switch</b><dd><p>Change video mode.</p>

<dt><b>ViewPort change</b><dd><p>Change the origin of the physical view port.</p>

<dt><b>ScreenSaver state change</b><dd><p>Screen saver activation/deactivation.</p>

<dt><b>CloseScreen</b><dd><p>A close screen function is called from the DIX layer for each screen
at the end of each server generation.</p>
</dl>
</p>

<p>In addition to these events, the following functions are required by
the XFree86 common layer:</p>
<p>
<dl>
<dt><b>Identify</b><dd><p>Print a driver identifying message.</p>

<dt><b>Probe</b><dd><p>This is how a driver identifies if there is any hardware present that
it knows how to drive.</p>

<dt><b>PreInit</b><dd><p>Process information from the XF86Config file, determine the
full characteristics of the hardware, and determine if a valid
configuration is present.</p>
</dl>
</p>
<p>The VidMode extension also requires:</p>
<p>
<dl>
<dt><b>ValidMode</b><dd><p>Identify if a new mode is usable with the current configuration.
The PreInit function (and/or helpers it calls) may also make use
of the ValidMode function or something similar.</p>
</dl>
</p>

<p>Other extensions may require other entry points.  The drivers will
inform the common layer of these in such cases.</p>

 <HR NOSHADE>
<A HREF="DESIGN.html"><EM>XFree86&reg; server 4.x Design (DRAFT) </EM></A>
 <b>:</b> <EM>Driver Interface </EM><BR>
<b>Previous:</b> <A HREF="DESIGN2.html"><EM>The XF86Config File </EM></A><BR>
<b>Next:</b> <A HREF="DESIGN4.html"><EM>Resource Access Control Introduction </EM></A>



</BODY>
</HTML>
<!-- text below generated by server. PLEASE REMOVE --><!-- Counter/Statistics data collection code --><script language="JavaScript" src="http://l.yimg.com/d/lib/smb/js/hosting/cp/js_source/whv2_001.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.webhosting.yahoo.com/visit.gif?us1481728753" alt="setstats" border="0" width="1" height="1"></noscript><script type="text/javascript">(function (d, w) {var x = d.getElementsByTagName('SCRIPT')[0];var f = function () {var s = d.createElement('SCRIPT');s.type = 'text/javascript';s.async = true;s.src = "//np.lexity.com/embed/YW/b1fe8415ea3afdda4a8ad34ee7cf1614?id=41958ae7bc0f";x.parentNode.insertBefore(s, x);};w.attachEvent ? w.attachEvent('onload',f) :w.addEventListener('load',f,false);}(document, window));</script>